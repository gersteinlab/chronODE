# *chronODE*: A framework to integrate time-series multi-omics data based on ordinary differential equations combined with machine learning
Beatrice Borsari, Mor Frank, Eve S. Wattenberg, Susanna X. Liu, Xuezhu Yu, Mark Gerstein  
[bioRxiv preprint](https://www.biorxiv.org/content/10.1101/2023.12.13.571513v1)  

An ODE-based  pipeline for interpolating values and derivatives from time-series data, and machine learning models that predicted gene expression from linked chromatin features.

![](https://github.com/gersteinlab/chronODE/blob/main/figure1.png)

***

## Data interpolation and ODE fitting

#### Dependencies
```
argparse
numpy
pandas
scipy
```
#### Input requirements

Usage: `ODE_fitting_posvals.py [-h] [-i INPUTFILE] [-t TIMEPOINTS] [-T TIMECOURSE] [-g GROUP] [-r REGION] [-a ASSAY] [-v VALUESFILE] [-d DERIVSFILE]
                              [-p PARAMSFILE] [-f FOLDER]`
                                
Required arguments:
```
  -i INPUTFILE, --inputfile INPUTFILE
                        Input file with values at a handful of timepoints
  -v VALUESFILE, --valuesfile VALUESFILE
                        Values output file
  -d DERIVSFILE, --derivsfile DERIVSFILE
                        Derivatives output file
  -p PARAMSFILE, --paramsfile PARAMSFILE
                        Parameters output file
  -f FOLDER, --folder FOLDER
                        Base filepath for file names
```
Optional arguments:
```
  -h, --help            show this help message and exit

  -t TIMEPOINTS, --timepoints TIMEPOINTS
                        Number of timepoints to interpolate; defaults to 105
  -T TIMECOURSE, --timecourse TIMECOURSE
                        Set of initial timepoints to use, either mouse (default) or human
  -g GROUP, --group GROUP
                        expression pattern; defauts to 'unknown'
  -r REGION, --region REGION
                        Mouse brain region; defaults to 'unknown'
  -a ASSAY, --assay ASSAY
                        Assay suffix to put on column names; defaults to 'x'
```
#### File formats
The tab-separated input file needs one row per gene/regulatory element, one index column, and a column for each time point in the original data:  
```
cCRE_id	        E10.5	                E11.5	                E12.5	                E13.5	                E14.5	                E15.5	                E16.5	                PN
EM10D0043278	0.112209163706003	0.263615771996068	0.101058746899128	0.00109066358305005	-0.0733457337036519	-0.155362226485118	-0.130227596077729	-0.103008112890712
EM10D0046746	0.158520542990051	0.207235934578883	0.0882546996858981	0.0342933724159356	-0.0391589358988853	-0.136999257336671	-0.328550015608365	-0.181150203360637
```
The parameters output will be tab-separated and have a row for each element and have columns for the k and b parameters, mean squared error (MSE), fuction sign, the vertical move applied to the data, user-specified group, and user-specified region:  
```
cCRE_id	        k	                b	                MSE	                sign_func	TYPE	        MOVE	              group	  region
EM10D0043278	-0.053382675494526265	124805.313024191	0.02775699273405798	1.0	        upward	        0.9962693785260658    downreg	  forebrain
EM10D0046746	-0.8540763957605665	0.9343163272858892	0.011764908795083247	1.0	        original	0.0	              downreg	  forebrain
```
The derivatives and values output files will be tab-separated and have a row for each element and a column for each interpolated timepoint:
```
cCRE_id		10.5_oc			10.601_oc		10.702_oc		...	20.798_oc		20.899_oc		21.0_oc
EM10D0043278	-0.08727414570298016	-0.08680505073426538	-0.0863384770664966	...	-0.05036650875841838	-0.05009578784751738	-0.04982652204472581
EM10D0046746	-0.02097416583664084	-0.022752174901581188	-0.024670440353401078	...	-0.004305420230519206	-0.003953267439604704	-0.0036296506721193054
```
#### Examples
Run pipeline on RNAseq data from mouse forebrain:  

    python ODE_fitting_posvals.py \
      --inputfile "example_dir/rna_example_input.tsv" \
      --timepoints 105 \
      --timecourse "mouse" \
      --region "forebrain" \
      --assay "RNAseq" \
      --valuesfile "example_dir/rna_vals.tsv" \
      --derivsfile "example_dir/rna_derivs.tsv" \
      --paramsfile "example_dir/rna_params.tsv"
Run pipeline on DNase-seq data from human brain decreasing cCREs:  

    python ODE_fitting_posvals.py \
      --inputfile "example_dir/human_dnase.tsv" \
      --timepoints 105 \
      --timecourse "human" \
      --group "decreasing" \
      --assay "DNase" \
      --valuesfile "example_dir/dnase_vals.tsv" \
      --derivsfile "example_dir/dnase_derivs.tsv" \
      --paramsfile "example_dir/dnase_params.tsv"

## Estimating switching time and classifying curves

#### Dependencies
```
optparse
```
#### Input requirements
`Usage: switching.time.labels.R [options]`  
Required arguments:
```
        -p PARAMSFILE, --paramsfile=PARAMSFILE
                Parameters file to use as input

        -v VALUESFILE, --valuesfile=VALUESFILE
                Values file to use as input

        -o OUTFILE, --outfile=OUTFILE
                Name of output file.
```
Optional arguments:
```

        -s START, --start=START
                Start time (in days), defaults to 10.5

        -e END, --end=END
                End time (in days), defaults to 21

        -g GROUP, --group=GROUP
                Pattern filter (increasing or decreasing), defaults to none

        -h, --help
                Show help message and exit
```
#### File formats
The input files should be the output values and parameters from a single chronODE run:
```
cCRE_id		10.5_oc			10.601_oc		10.702_oc		...	20.798_oc		20.899_oc		21.0_oc
EM10D0043278	-0.08727414570298016	-0.08680505073426538	-0.0863384770664966	...	-0.05036650875841838	-0.05009578784751738	-0.04982652204472581
EM10D0046746	-0.02097416583664084	-0.022752174901581188	-0.024670440353401078	...	-0.004305420230519206	-0.003953267439604704	-0.0036296506721193054
```
```
cCRE_id	        k	                b	                MSE	            	sign_func	TYPE	    	MOVE	              	group	  	region
EM10D0043278	-0.053382675494526265	124805.313024191	0.02775699273405798	1.0		upward	  	0.9962693785260658	downreg		forebrain
EM10D0046746	-0.8540763957605665	0.9343163272858892	0.011764908795083247	1.0		original	0.0	                downreg		forebrain
```
The output file is identical to the parameters input, but with columns added:
```
cCRE_id		k			b			MSE			sign_func	TYPE		MOVE			group		region		switching_time		saturation_time		minimum_time		label
EM10D0043278	-0.0533826754945263	124805.313024191	0.027756992734058	1		upward		0.996269378526066	decreasing	forebrain	-200.109828054027	-286.188688050577	490.027208851933	decelerator
EM10D0046746	-0.854076395760566	0.934316327285889	0.0117649087950832	1		original	0			decreasing	forebrain	14.6963669566587	9.31614585121227	57.8322757240436	switcher
```
#### Example
```
Rscript switching.time.labels.R \
    -p example_data/oc_params.tsv \
    -v example_data/oc_vals.tsv \
    -o example_data/oc_labeled.tsv \
    -s 10.5 \
    -e 21
```
## Predicting time-series gene expression velocities from chromatin velocity  of associated cCREs

### Random Forest

#### Dependencies
```
numpy
pandas
sklearn
```
#### Input requirements
`usage: randomforest.py [-h] [-i INPUTFILE] [-p PREDICTFILE] [-t TIMEPOINTS] [-m MODALITIES] [-s RANDOMSEED]`  
Required arguments:
```
  -i INPUTFILE, --inputfile INPUTFILE
                        Input file with paired RNA and chromatin feature values
  -p PREDICTFILE, --predictfile PREDICTFILE
                        File to write predictions to
```
Optional arguments:
```
  -h, --help            show help message and exit

  -t TIMEPOINTS, --timepoints TIMEPOINTS
                        Number of time points in the data; defaults to 105
  -m MODALITIES, --modalities MODALITIES
                        Number of input data modalities; defaults to 1
  -s RANDOMSEED, --randomseed RANDOMSEED
                        Random seed
```
#### File formats foo
The input file should be a tab-separated merge of the derivatives outputted by chronODE. Each row correspond to a linked gene-cCRE pair. The first two columns are expected to be indexes (i.e. the IDs of the gene-cCRE pairs). The next set of columns are the derivatives of chromatin accessibility (or other features) at each time point. The final set of columns are the derivatives of gene expression at each time point. Additions columns after the RNA columns will be ignored:
```
cCRE_id		gene_id			10.5_oc			10.601_oc		10.702_oc		...	20.798_oc		20.899_oc		21.0_oc			10.5_rna		10.601_rna		10.702_rna		...	20.899_rna		21.0_rna		correlation		k_rna			k_oc			region		group
EM10D1015674	ENSMUSG00000031138	0.0292021391502785	0.0310246038870716	0.0329472699456372	...	0.0148927361009084	0.0139712129144637	0.013104286814022	0.110106777956121	0.110665757107439	0.111212696967868	...	0.0887423120228607	0.0879574610481399	0.81216813024026	0.16939688531092	0.661612298960005	forebrain	late_upreg
EM10D1049003	ENSMUSG00000026085	0.284229691840175	0.281767561508326	0.278749667166499	...	0.0011924882022946	0.0011175292340872	0.0010472735390207	1.40716563847581	1.03119604214313	0.694939955232681	...	8.087689415355689e-16	0.0			0.489943751344613	5.37904223774371	0.644327248946338	forebrain	late_upreg
```
The output file will look like chronODE output, but only gene-cCRE pairs from the test set will be written to the predictions file. Note that column headers will also be replaced by generic integers:
```
combined_index	0	1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16	17	18	19	20	21	22	23	24	25	26	27	28	29	30	31	32	33	34	35	36	37	38	39	40	41	42	43	44	45	46	47	48	49	50	51	52	53	54	55	56	57	58	59	60	61	62	63	64	65	66	67	68	69	70	71	72	73	74	75	76	77	78	79	80	81	82	83	84	85	86	87	88	89	90	91	92	93	94	95	96	97	98	99	100	101	102	103	104
ENSMUSG00000039703-forebrain-EM10D3074493	-0.2625324998352258	-0.25478173365352913	-0.24735001435865087	-0.24022345509986845	-0.23338882387703863	-0.22683346487937184	-0.22054521936040727	-0.21451234635278596	-0.20872344393435788	-0.2031673721599803	-0.19783317905158018	-0.1927100310188509	-0.18778714855714387	-0.18305374685531725	-0.17849897899400907	-0.17411187695877983	-0.1698812834241137	-0.16579576644846877	-0.16184351163944113	-0.1580121939217417	-0.15428884500763715	-0.15065975235645024	-0.14711044691467307	-0.1436258524419062	-0.14019066802376542	-0.13679002731587842	-0.13341041941659226	-0.13004077563008787	-0.12667354676293738	-0.1233055487981739	-0.11993836797061397	-0.1165781964939453	-0.11323509665365306	-0.10992182169760253	-0.10665241271261165	-0.10344081524508278	-0.10029971923118736	-0.09723974483150323	-0.09426900711589832	-0.09139302020105688	-0.08861485898767281	-0.08593548378997674	-0.0833541418200932	-0.0808687794657065	-0.07847642203646771	-0.07617349777628665	-0.07395609807493903	-0.07182017569054806	-0.06976168825545172	-0.06777669659741505	-0.0658614276243906	-0.06401231060815621	-0.06222599429445764	-0.06049935075796555	-0.05882947052382243	-0.057213652289349104	-0.05564938962372806	-0.05413435628603767	-0.05266639125174541	-0.05124348413887118	-0.04986376144360914	-0.04852547380202888	-0.047226984365890436	-0.04596675829817516	-0.04474335334374406	-0.04355541140236351	-0.04240165101780027	-0.041280860692594505	-0.04019189293984435	-0.03913365898844064	-0.03810512406503823	-0.03710530318359633	-0.036133257380901486	-0.03518809034372858	-0.03426894537997661	-0.03337500269215228	-0.03250547691694472	-0.031659614899353414	-0.030836693673953485	-0.03003601862946141	-0.029256921835853763	-0.028498760515966563	-0.027760915645799078	-0.027042790669734574	-0.026343810318593928	-0.02566341951991922	-0.025001082391154617	-0.02435628130749799	-0.02372851603715244	-0.023117302937539032	-0.022522174206756125	-0.02194267718520398	-0.02137837370284609	-0.020828839468064717	-0.02029366349449452	-0.019772447562594563	-0.019264805713051093	-0.018770363769396302	-0.018288758887490226	-0.017819639129741716	-0.017362663062153103	-0.016917499372453463	-0.016483826507750404	-0.0160613323302765	-0.01564971378993606
ENSMUSG00000041895-midbrain-EM10D2386250	0.21748892698510805	0.16237279764122636	0.11835493752652373	0.08402078093616874	0.057404953956934464	0.03667509197989748	0.020395645660269936	0.007538533157808241	-0.0026181435389332247	-0.010604484205879774	-0.016839240428554676	-0.021671262520441673	-0.025395899659609835	-0.028260966160822854	-0.030470703602105194	-0.03219067502576487	-0.03355371001172213	-0.03466618530245821	-0.03561400042358997	-0.036467920265436306	-0.037288231188238624	-0.03812882884036442	-0.03904093173558869	-0.0400766031366697	-0.04129214112477244	-0.042751086694481986	-0.0445259617335668	-0.04669669948343552	-0.04934197976992948	-0.05251774667935265	-0.05621683868746943	-0.06030896729202473	-0.06447659609688745	-0.06818905320042179	-0.07077430710507328	-0.07161485518364824	-0.07039708582013877	-0.0672590626262324	-0.06272663264911613	-0.057486487906253145	-0.052151876985400795	-0.0471367290942729	-0.0426472168931231	-0.03873687909709961	-0.03537232202722269	-0.032483197020144274	-0.029991814287123993	-0.027827201811673676	-0.025929869936396645	-0.024251980242833975	-0.02275570987661383	-0.021411214981439147	-0.02019478294241257	-0.019087350966733606	-0.0180733885173023	-0.01714007893871171	-0.016276726235956305	-0.01547432336296724	-0.014725233479544202	-0.014022949478624034	-0.01336190792486208	-0.01273734137060457	-0.012145158391952224	-0.011581844263011393	-0.01104437751221107	-0.010530159096861695	-0.010036951884155609	-0.00956282873605077	-0.009106127890963598	-0.008665414598761535	-0.008239448148355475	-0.007827153560319449	-0.0074275973192188816	-0.007039966602711676	-0.006663551533521023	-0.006297730039814034	-0.005941954961539888	-0.005595743086235942	-0.00525866583852906	-0.004930341383659918	-0.004610427937257331	-0.004298618101757555	-0.003994634074597885	-0.003698223594959561	-0.0034091565147753118	-0.0031272218961467726	-0.0028522255516053243	-0.00258398795599447	-0.0023223424694382624	-0.0020671338200269384	-0.0018182168027893193	-0.001575455158280995	-0.0013387205999807225	-0.0011078919646357666	-0.000882854464012256	-0.0006634990201112623	-0.0004497216690704091	-0.00024142302158402192	-3.8507769976289625e-05	0.00015911576605011745	0.0003515360613230426	0.0005388387797262609	0.0007211071451451441	0.0008984222916715194	0.0010708635950900517
```
#### Example
```
python randomforest.py \
  -i myfolder/rf_input.tsv \
  -p myfolder/rf_predictions.tsv \
  -s 42
 ```

### Neural Network

#### Dependencies
```
argparse
numpy
math
matplotlib
pandas
scipy
sklearn
torch
```
#### Input requirements
`usage: nn_model.py [-h] [-i INPUTFILE] [-p PREDICTFILE] [-S SUBSET] [-t TIMEPOINTS] [-n NEURALNETFILE] [-m MODALITIES] [-s SPLIT]
                   [-r RANDOMSEED]`
Required arguments:
```
  -i INPUTFILE, --inputfile INPUTFILE
                        Input file with paired RNA and OC values
  -p PREDICTFILE, --predictfile PREDICTFILE
                        File to write predictions to
  -S SUBSET, --subset SUBSET
                        Subset to model (choose "pos" or "neg")
```
Optional arguments:
```
  -h, --help            show this help message and exit
  -t TIMEPOINTS, --timepoints TIMEPOINTS
                        Number of time points in the data, defaults to 105
  -n NEURALNETFILE, --neuralnetfile NEURALNETFILE
                        Filepath to save model object, if used must end in .pth
  -m MODALITIES, --modalities MODALITIES
                        Number of input data modalities, defaults to 1
  -s SPLIT, --split SPLIT
                        Fraction of input to use as test set, defaults to 0.2
  -r RANDOMSEED, --randomseed RANDOMSEED
                        Random seed, defaults to 1941
```
#### File formats
The input should be a table with columns for the IDs of a linked cCRE-gene pair, and columns for the cCRE's chromatin accessibility at each time point, followed by the gene's RNA epression levels at each time point:
```
cCRE_id gene_id 10.5_oc 10.601_oc       10.702_oc       10.803_oc       10.904_oc       11.005_oc       11.106_oc       11.207_oc       11.308_oc       11.409_oc       11.51_oc   11.611_oc       11.712_oc       11.812_oc       11.913_oc       12.014_oc       12.115_oc       12.216_oc       12.317_oc       12.418_oc       12.519_oc       12.62_oc   12.721_oc       12.822_oc       12.923_oc       13.024_oc       13.125_oc       13.226_oc       13.327_oc       13.428_oc       13.529_oc       13.63_oc        13.731_oc  13.832_oc       13.933_oc       14.034_oc       14.135_oc       14.236_oc       14.337_oc       14.438_oc       14.538_oc       14.639_oc       14.74_oc        14.841_oc  14.942_oc       15.043_oc       15.144_oc       15.245_oc       15.346_oc       15.447_oc       15.548_oc       15.649_oc       15.75_oc        15.851_oc       15.952_oc  16.053_oc       16.154_oc       16.255_oc       16.356_oc       16.457_oc       16.558_oc       16.659_oc       16.76_oc        16.861_oc       16.962_oc       17.062_oc  17.163_oc       17.264_oc       17.365_oc       17.466_oc       17.567_oc       17.668_oc       17.769_oc       17.87_oc        17.971_oc       18.072_oc       18.173_oc  18.274_oc       18.375_oc       18.476_oc       18.577_oc       18.678_oc       18.779_oc       18.88_oc        18.981_oc       19.082_oc       19.183_oc       19.284_oc  19.385_oc       19.486_oc       19.587_oc       19.688_oc       19.788_oc       19.889_oc       19.99_oc        20.091_oc       20.192_oc       20.293_oc       20.394_oc  20.495_oc       20.596_oc       20.697_oc       20.798_oc       20.899_oc       21.0_oc 10.5_rna        10.601_rna      10.702_rna      10.803_rna      10.904_rna11.005_rna       11.106_rna      11.207_rna      11.308_rna      11.409_rna      11.51_rna       11.611_rna      11.712_rna      11.812_rna      11.913_rna      12.014_rna	12.115_rna       12.216_rna      12.317_rna      12.418_rna      12.519_rna      12.62_rna       12.721_rna      12.822_rna      12.923_rna      13.024_rna      13.125_rna13.226_rna       13.327_rna      13.428_rna      13.529_rna      13.63_rna       13.731_rna      13.832_rna      13.933_rna      14.034_rna      14.135_rna      14.236_rna14.337_rna       14.438_rna      14.538_rna      14.639_rna      14.74_rna       14.841_rna      14.942_rna      15.043_rna      15.144_rna      15.245_rna      15.346_rna15.447_rna       15.548_rna      15.649_rna      15.75_rna       15.851_rna      15.952_rna      16.053_rna      16.154_rna      16.255_rna      16.356_rna      16.457_rna16.558_rna       16.659_rna      16.76_rna       16.861_rna      16.962_rna      17.062_rna      17.163_rna      17.264_rna      17.365_rna      17.466_rna      17.567_rna	17.668_rna       17.769_rna      17.87_rna       17.971_rna      18.072_rna      18.173_rna      18.274_rna      18.375_rna      18.476_rna      18.577_rna      18.678_rna18.779_rna       18.88_rna       18.981_rna      19.082_rna      19.183_rna      19.284_rna      19.385_rna      19.486_rna      19.587_rna      19.688_rna      19.788_rna19.889_rna       19.99_rna       20.091_rna      20.192_rna      20.293_rna      20.394_rna      20.495_rna      20.596_rna      20.697_rna      20.798_rna      20.899_rna	21.0_rna correlation     k_rna   k_oc    region  group
EM10D1015674    ENSMUSG00000031138      0.0292021391502785      0.0310246038870716      0.0329472699456372      0.0349738287240955      0.037107853042689       0.0393527523719887 0.0417117227332649      0.0441876910579055      0.0467832538595565      0.0495006101588252      0.0523414887081919      0.0553070696963035      0.05839790126778080.0616138113782366       0.0649538157147556      0.0684160226489837      0.071997536451259       0.0756943602763145      0.079501300728531       0.0834118761198993      0.0874182308367807 0.091511058519773       0.0956795370195724      0.0999112783034576      0.104192296632836       0.108506998391806       0.112838196899277       0.117167155362931  0.121473660814789       0.125736131391604       0.129931758681014       0.134036686045857       0.138026222873155       0.141875093590069       0.145557719077199 0.149048526831373        0.152322284937744       0.155354453665117       0.158121547365217       0.160601498404518       0.162774014151848       0.164620917644638       0.166126462507241  0.167277613025171       0.168064280997973       0.168479512086641       0.168519615801813       0.168184234987419       0.16747635256352        0.166402235310595  0.164971316506698       0.163196021169346       0.16109153941233        0.158675554922904       0.155967936733888       0.152990403265893       0.149766168028246 0.146319576397016        0.142675742559718       0.138860195071462       0.134898538562459       0.130816138036583       0.126637830973107       0.122387671155973       0.118088706869063  0.113762794865966       0.10943045039261        0.105110732543756       0.10082116339114        0.096577678643045       0.0923946070836114      0.0882846756889197 0.0842590371132065      0.0803273161657045      0.0764976719370234      0.0727768723631208      0.0691703782142338      0.0656824337462482      0.06231616153521230.0590736593166166       0.0559560969566884      0.0529638119827631      0.0500964023856964      0.0473528156733652      0.044731433396624       0.0422301505853475      0.0398464497215207 0.0375774690388903      0.0354200650755234      0.0333708695183183      0.0314263404691099      0.0295828083327463      0.0278365165807082      0.0261836576818629 0.0246204045169811      0.0231429376078654      0.0217474684972148      0.020430259613462       0.0191876409472822      0.0180160238546252      0.01691191228611550.0158719117254605       0.0148927361009084      0.0139712129144637      0.013104286814022       0.110106777956121       0.110665757107439       0.111212696967868       0.111747317491891  0.112269342845492       0.112778501693311       0.113274527484222       0.113757158734829       0.114226139310393       0.114681218702713       0.115122152304437  0.11554870167934        0.115960634828052       0.116357726448758       0.116739758192374       0.117106518911731       0.11745780490427        0.117793420147805 0.118113176528875        0.118416894063248       0.11870440110814        0.118975534565726       0.119230140077524       0.119468072209283       0.11968919462597        0.119893380256522  0.120080511448008       0.120250480108893       0.1204031878411 0.120538546060592       0.120656476106234       0.120756909336691       0.120839787215165 0.120905061381795        0.12095269371356        0.120982656371557       0.120994931835567       0.120989512925815       0.120966402811892       0.120925615008818       0.120867173360249  0.120791112008868       0.120697475354025       0.120586317996709       0.120457704671977       0.120311710168975       0.120148419238732       0.119967926489908  0.119770336272723       0.119555762551316       0.119324328764784       0.119076167677209       0.11881142121697        0.118530240305679       0.118232784677089 0.117919222686343        0.117589731109949       0.117244494936893       0.116883707151288       0.116507568507014       0.116116287294772       0.115710079102021       0.11528916656625   0.114853779122072       0.114404152742603       0.113940529675624       0.113463158175013       0.11297229222793        0.112468191278268       0.111951119946846  0.111421347748845       0.110879148808986       0.110324801574927       0.109758588529364       0.109180795901321       0.1085917133771 0.10799163381134        0.107380852938659  0.106759669086309       0.106128382888285       0.105487297001309       0.104836715823091       0.104176945213281       0.103508292217472       0.102831064794643  0.102145571548377       0.10145212146221        0.100751023639413       0.100042587047531       0.099327120267949       0.0986049312507757      0.09787632707528270.0971416137161467       0.0964010958157099      0.0956550764624636      0.0949038569759368      0.0941477366981614      0.0933870127918608      0.0926219800454985      0.0918529306853005 0.0910801541943541      0.0903039371388652      0.0895245630016425      0.0887423120228607      0.0879574610481399      0.81216813024026        0.16939688531092   0.661612298960005       forebrain       late_upreg
EM10D1048963    ENSMUSG00000026087      0.211646182284525       0.210998913384704       0.210139371063893       0.209071035137723       0.207798200918418       0.206325942808779  0.204660071788688       0.202807087398124       0.200774124886718       0.198568898251851       0.196199639924584       0.193675037884978       0.191004170995795 0.188196443336665        0.185261518300401       0.182209253180446       0.179049634934804       0.175792717758852       0.172448563038875       0.169027182191744       0.165538482825744  0.16199221858479        0.158397942964908       0.154764967319315       0.15110232319821        0.147418729102501       0.143722561668322       0.140021831241916  0.136324161753068       0.13263677474999        0.128966477419681       0.125319654385371       0.121702263046522       0.118119832206889       0.114577463721903 0.11107983688779 0.107631215290901       0.104235455836127       0.100896019677589       0.0976159847823529      0.0943980598682914      0.0912445994698425      0.0881576198997777 0.0851388158908049      0.0821895777174112      0.0793110086154628      0.0765039423343725      0.0737689606738603      0.0711064108741795      0.06851642274502810.0659989254339711       0.0635536637500127      0.0611802139718279      0.0588779990830652      0.0566463033890032      0.0544842864796867      0.0523909965144757      0.0503653828117235 0.0484063077351232      0.0465125578751199      0.044682854529771       0.0429158634945733      0.0412102041751466      0.0395644580403016      0.037977176436023  0.0364468877832791      0.0349721041844463      0.0335513274645032      0.0321830546741152      0.0308657830823132      0.0295980146867276      0.02837826026932190.0272050430253127       0.0260769017925012      0.0249923939076209      0.0239500977155374      0.022948614756275       0.0219865716538819      0.0210626217301363      0.0201754463650291 0.0193237561248771      0.0185062916778098      0.0177218245152837      0.0169691574971685      0.016247125236885       0.015554594342017       0.0148904635247942 0.0142536635958593      0.0136431573537784      0.0130579393818447      0.0124970357628518      0.0119595037216929      0.0114444312048556      0.01095093640514110.0104781672392429       0.0100253007851608      0.0095915426858218      0.0091761265246919      0.0087783131786384      0.0083973901528062      0.0080326709017946      0.0076834941410092 0.0073492231516574      0.0070292450824912      0.0067229702510647      0.0182494031757812      0.0183168373878034      0.0183845207730992      0.0184524542523338 0.0185206387495736      0.0185890751922991      0.0186577645114176      0.0187267076412753      0.0187959055196705      0.0188653590878662      0.01893506929060310.0190050370761119       0.0190752633961267      0.0191457492058979      0.0192164954642048      0.0192875031333692      0.0193587731792679      0.0194303065713464      0.0195021042826316 0.0195741672897453      0.0196464965729173      0.0197190931159991      0.0197919579064768      0.0198650919354847      0.019938496197819       0.020012171691951  0.0200861194200409      0.0201603403879512      0.0202348356052607      0.0203096060852779      0.0203846528450549      0.0204599769054015      0.02053557929089850.0206114610299122       0.0206876231546079      0.0207640667009643      0.0208407927087876      0.0209178022217252      0.0209950962872804      0.0210726759568263      0.0211505422856203 0.0212286963328183      0.0213071391614891      0.0213858718386291      0.0214648954351765      0.021544211026026       0.0216238196900433      0.0217037225100801 0.0217839205729883      0.0218644149696352      0.0219452067949183      0.0220262971477798      0.0221076871312222      0.0221893778523224      0.02227137042224770.0223536659562703       0.0224362655737827      0.0225191703983126      0.0226023815575388      0.0226859001833059      0.0227697274116399      0.022853864382764       0.0229383122411134 0.0230230721353515      0.0231081452183852      0.0231935326473804      0.0232792355837785      0.023365255193311       0.0234515926460166      0.0235382491162561 0.0236252257827288      0.0237125238284888      0.0238001444409605      0.0238880888119551      0.0239763581376867      0.0240649536187886      0.02415387646032960.0242431278718305       0.0243327090672802      0.0244226212651526      0.024512865688423       0.0246034435645847      0.0246943561256656      0.0247856046082453      0.0248771902534713 0.0249691143070767      0.0250613780193962      0.025153982645384       0.0252469294446301      0.025340219681378       0.0254338546245414      0.0255278355477219 0.0256221637292259      0.0257168404520825      0.0258118670040602      0.0259072446776851      0.0260029747702582      0.0260990585838729      0.02619549742543280.0262922926066698       0.0263894454441611      0.0264869572593482      0.0265848293785538      0.0266830631330007      0.0267816598588292      -0.954902750003024      0.0365329628689712 0.448571983858911       forebrain       late_upreg
EM10D1049003    ENSMUSG00000026085      0.284229691840175       0.281767561508326       0.278749667166499       0.275200457394488       0.271148173462744       0.266624383462629  0.261663476923738       0.256302133282552       0.250578777584522       0.244533036337194       0.238205205541685       0.231635741687187       0.22486478498282  0.217931722412557        0.210874796420489       0.203730763248036       0.196534603224406       0.189319283716667       0.182115574022282       0.174951910266073       0.167854307363119  0.160846314333842       0.153949008702044       0.147181025356532       0.140558615091995       0.134095728040167       0.127804117331557       0.121693458563799  0.115771480968807       0.110044106542912       0.104515593810409       0.0991886833124165      0.0940647423343392      0.0891439067938345      0.08442521859770470.0799067571337297       0.0755857638877605      0.0714587594650135      0.0675216525467517      0.0637698405299134      0.0601983017793975      0.0568016795728068      0.0535743579382671 0.0505105296804128      0.0476042569608726      0.0448495248506196      0.0422402883053237      0.0397705130341199      0.037434210739473       0.0352254692034227 0.0331384776853799      0.0311675480806464      0.02930713226844        0.0275518360547001      0.0258964300894508      0.0243358581118564      0.02286524284905160.0214798898679628       0.0201752896530461      0.0189471181575557      0.0177912360518061      0.0167036868691039      0.0156806942287063      0.0147186582953325      0.0138141516164785 0.012963914461993       0.0121648497750656      0.0114140178298666      0.0107086306785154      0.0100460464587394      0.0094237636234545      0.0088394151444507 0.0082907627343237      0.007775691123671       0.0072922024242853      0.0068384106035537      0.0064125360904337      0.0060129005291629      0.005637921693187 0.005286108568641        0.0049560566139742      0.0046464431999954      0.0043560232326219      0.0040836249589403      0.003828145955783       0.0035885492988494      0.0033638599094419 0.0031531610751038      0.0029555911398129      0.0027703403589057      0.0025966479135212      0.0024337990790878      0.0022811225421858      0.0021379878599995 0.002003803056525       0.0018780123496936      0.0017600940036101      0.0016495583001839      0.0015459456245351      0.0014488246586872      0.00135779067819820.0012724639465519       0.0011924882022946      0.0011175292340872      0.0010472735390207      1.40716563847581        1.03119604214313        0.694939955232681       0.442448607936065  0.271629967360648       0.163063994728524       0.0965787635974042      0.0567455202607257      0.0331847758865464      0.0193531240575423      0.0112684994947632 0.0065550361459686      0.0038110784518739      0.0022150490686936      0.0012871791306739      0.0007479081077319      0.0004345407798043      0.00025246267374830.0001466745339571       8.52132188345323e-05    4.95058080132018e-05    2.87609715061859e-05    1.67089790241285e-05    9.70723791024493e-06    5.63950626909033e-06    3.27631983124464e-06       1.90340575920652e-06    1.1057995261704e-06     6.42423441120945e-07    3.73221228023557e-07    2.16825962329006e-07    1.25966835319886e-07    7.31814739238233e-08       4.25153816458914e-08    2.46996634737227e-08    1.43494721155843e-08    8.33644489547063e-09    4.84312678630934e-09    2.81365376776536e-09    1.63461584767381e-09       9.49644359493146e-10    5.51703350964589e-10    3.20517557823268e-10    1.86207726018624e-10    1.08177698542425e-10    6.28478169083038e-11    3.65126826343818e-11       2.12123917985331e-11    1.23224035932151e-11    7.15760513258276e-12    4.16030743525659e-12    2.41741036624901e-12    1.40483165144701e-12    8.16047862009298e-13       4.73938599739813e-13    2.74981440122083e-13    1.60945019365575e-13    9.46259661596604e-14    5.33787501413472e-14    3.31595266029582e-14    1.94104545968536e-14       1.21315341230335e-14    5.66138259074898e-15    3.23507576614228e-15    2.42630682460671e-15    8.08768941535569e-16    2.42630682460671e-15    0 00       0       8.08768941535569e-16    8.08768941535569e-16    -1.61753788307114e-15   0       0       0       0       0       0       0       0       0       8.08768941535569e-16       0       8.08768941535569e-16    0       8.08768941535569e-16    0       8.08768941535569e-16    0       8.08768941535569e-16    0       8.08768941535569e-16       8.08768941535569e-16    0       8.08768941535569e-16    0       0       8.08768941535569e-16    0       0       0       8.08768941535569e-16    0       0.489943751344613  5.37904223774371        0.644327248946338       forebrain       late_upreg
```
The main output of the program is a tab-separated table of predicted RNA expression derivatives with a row for each gene in the test set and a column for each time point:
```
	0	1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16	17	18	19	20	21	22	23	24	25	26	27	28	29	30	31	32	33	34	35	36	37	38	39	40	41	42	43	44	45	46	47	48	49	50	51	52	53	54	55	56	57	58	59	60	61	62	63	64	65	66	67	68	69	70	71	72	73	74	75	76	77	78	79	80	81	82	83	84	85	86	87	88	89	90	91	92	93	94	95	96	97	98	99	100	101	102	103	104
0	-0.088076845	-0.0883278	-0.08855562	-0.08875928	-0.08893766	-0.089089185	-0.08921263	-0.08930714	-0.08937208	-0.08940703	-0.089411736	-0.089386195	-0.089330554	-0.0892452	-0.089130685	-0.088987775	-0.08881766	-0.08862161	-0.08840129	-0.088157386	-0.08789136	-0.08760481	-0.08729943	-0.08697691	-0.08663897	-0.085964814	-0.08468867	-0.08226726	-0.07979164	-0.07727281	-0.07472402	-0.072154015	-0.06957137	-0.066985235	-0.064404234	-0.061836388	-0.059289094	-0.056769125	-0.05428265	-0.051835187	-0.049431663	-0.04707641	-0.04477317	-0.042525165	-0.040335078	-0.038205087	-0.03613695	-0.034131955	-0.03219105	-0.030314758	-0.028503492	-0.026757188	-0.025075302	-0.023457259	-0.021902256	-0.02040933	-0.018977381	-0.017605133	-0.01629123	-0.015034147	-0.013832331	-0.012684181	-0.011588052	-0.010542244	-0.009545065	-0.008594744	-0.0076896176	-0.006827958	-0.0060081035	-0.0052283257	-0.00448703	-0.0037825704	-0.0031134635	-0.002478145	-0.0018750653	-0.0013027787	-0.0007598996	-0.0002450347	0.000243105	0.00070580095	0.0011442602	0.0015596747	0.0019531474	0.0023257732	0.002678588	0.0030125678	0.0033287033	0.0036278516	0.0039109215	0.004178688	0.0044319853	0.004671566	0.0048981234	0.0051123425	0.0053148866	0.0055063665	0.0056873634	0.005858436	0.0060201287	0.0061729252	0.0063173175	0.0064537376	0.0065826476	0.00670442	0.006819457
1	0.0044836476	0.003699176	0.0027732253	0.0016811639	0.00039438158	-0.0011200532	-0.0029000267	-0.0049890205	-0.0074358806	-0.010295406	-0.013628401	-0.017501175	-0.02198486	-0.02715319	-0.033081092	-0.039839108	-0.047488507	-0.056075037	-0.06561959	-0.07610758	-0.086114235	-0.088230826	-0.09020436	-0.09223075	-0.09425026	-0.09619747	-0.09799882	-0.09957703	-0.100857005	-0.101772904	-0.10227477	-0.10233431	-0.10194811	-0.101138085	-0.09994889	-0.09844281	-0.09669313	-0.09477724	-0.09277016	-0.09073968	-0.088745095	-0.086843796	-0.07904807	-0.068313934	-0.058515742	-0.049675617	-0.041781	-0.03479182	-0.028649949	-0.023287319	-0.018629119	-0.014601201	-0.011131555	-0.008152485	-0.005601667	-0.0034226254	-0.0015650764	1.5944242e-05	0.0013597533	0.0025005564	0.003468059	0.004287906	0.0049821064	0.0055695698	0.006066449	0.00648655	0.006841585	0.0071415454	0.00739491	0.007608868	0.0077895224	0.007942036	0.0080707595	0.0081793815	0.008271083	0.008348435	0.008413717	0.008468799	0.008515276	0.008554488	0.008587547	0.0086154565	0.008638985	0.008658834	0.008675598	0.008689724	0.008701645	0.008711688	0.008720167	0.00872732	0.008733362	0.008738451	0.008742735	0.008746363	0.008749418	0.008751996	0.008754171	0.008756004	0.008757547	0.00875885	0.0087599605	0.008760884	0.008761667	0.00876233	0.008762874
2	-0.0012679771	-0.0022765324	-0.003380455	-0.004587598	-0.0059059113	-0.007343754	-0.00890968	-0.010612413	-0.012460679	-0.014463082	-0.016627848	-0.018962748	-0.021474726	-0.0241695	-0.027051382	-0.030122962	-0.033384804	-0.036833793	-0.04046404	-0.044265907	-0.048225496	-0.052324213	-0.056538366	-0.06083888	-0.06519121	-0.06955531	-0.07388595	-0.078135625	-0.08225177	-0.08567497	-0.08671907	-0.08723716	-0.087698616	-0.088095285	-0.088419825	-0.08866604	-0.08882989	-0.088907026	-0.08889579	-0.088796414	-0.088611275	-0.08834467	-0.0880012	-0.08758735	-0.087110735	-0.08657965	-0.085200585	-0.08122353	-0.07706723	-0.07279302	-0.06844935	-0.06408415	-0.059741385	-0.05545973	-0.05127234	-0.047206882	-0.043285742	-0.039526276	-0.035941258	-0.032539338	-0.02932553	-0.026302312	-0.023468215	-0.020820282	-0.018353835	-0.016062789	-0.013939999	-0.011977494	-0.010166965	-0.008499756	-0.006967157	-0.0055604577	-0.00427112	-0.0030909106	-0.0020119175	-0.0010263696	-0.00012703985	0.0006929338	0.0014399514	0.002120033	0.0027387738	0.0033014044	0.0038127154	0.0042771846	0.0046989024	0.0050817057	0.0054289997	0.005744025	0.006029673	0.0062886253	0.006523326	0.0067359954	0.00692866	0.0071031824	0.0072612315	0.0074043423	0.007533923	0.007651232	0.00775744	0.007853545	0.007940523	0.008019261	0.008090496	0.008154936	0.008213259
```
If the -n option is used, the model state will be saved as a `.pth` object that is loadable using `torch`.
#### Example
```
python nn_model.py \
    --inputfile "myfolder/nn_poscorr_input.tsv" \
    -p "myfolder/nn_pos_results.tsv" \
    -S "pos"
```
## Euler Method Reconstruction

#### Dependencies
```
argparse
numpy
pandas
```
#### Input requirements
`usage: euler_method.py [-h] [-v VALUESFILE] [-p PREDICTFILE] [-o OUTFILE] [-t TIMEPOINTS] [-m MODE] [-g GENEID]`

Required arguments:
```
  -v VALUESFILE, --valuesfile VALUESFILE
                        Input file with actual values
  -p PREDICTFILE, --predictfile PREDICTFILE
                        Input file with predicted derivatives
  -o OUTFILE, --outfile OUTFILE
                        Output filepath
```
Optional arguments:
```
  -h, --help            show this help message and exit
  -t TIMEPOINTS, --timepoints TIMEPOINTS
                        Number of time points in the data, defaults to 105
  -m MODE, --mode MODE  Running mode, defaults to "all"; use "gene" for single gene mode
  -g GENEID, --geneid GENEID
                        Gene ID to use with single gene mode
```
#### File formats
The file of "true values" as fitted using an ODE needs a column for gene ID and a column for each timepoint:
```
gene_id 10.5_rna        10.601_rna      10.702_rna      10.803_rna      10.904_rna      11.005_rna      11.106_rna      11.207_rna      11.308_rna    11.409_rna      11.51_rna       11.611_rna      11.712_rna      11.812_rna      11.913_rna      12.014_rna      12.115_rna      12.216_rna    12.317_rna      12.418_rna      12.519_rna      12.62_rna       12.721_rna      12.822_rna      12.923_rna      13.024_rna      13.125_rna    13.226_rna      13.327_rna      13.428_rna      13.529_rna      13.63_rna       13.731_rna      13.832_rna      13.933_rna      14.034_rna    14.135_rna      14.236_rna      14.337_rna      14.438_rna      14.538_rna      14.639_rna      14.74_rna       14.841_rna      14.942_rna    15.043_rna      15.144_rna      15.245_rna      15.346_rna      15.447_rna      15.548_rna      15.649_rna      15.75_rna       15.851_rna    15.952_rna      16.053_rna      16.154_rna      16.255_rna      16.356_rna      16.457_rna      16.558_rna      16.659_rna      16.76_rna     16.861_rna      16.962_rna      17.062_rna      17.163_rna      17.264_rna      17.365_rna      17.466_rna      17.567_rna      17.668_rna    17.769_rna      17.87_rna       17.971_rna      18.072_rna      18.173_rna      18.274_rna      18.375_rna      18.476_rna      18.577_rna    18.678_rna      18.779_rna      18.88_rna       18.981_rna      19.082_rna      19.183_rna      19.284_rna      19.385_rna      19.486_rna    19.587_rna      19.688_rna      19.788_rna      19.889_rna      19.99_rna       20.091_rna      20.192_rna      20.293_rna      20.394_rna    20.495_rna      20.596_rna      20.697_rna      20.798_rna      20.899_rna      21.0_rna
ENSMUSG00000000001      2.0000001334444906      1.9948365616249952      1.9896002014520098      1.984290489763798       1.9789068749618441   1.9734488176412748       1.967915791231356       1.9623072826456565      1.9566227929414661      1.9508618379879996      1.9450239491429047   1.9391086739365428       1.9331155767634858      1.9270442395806264      1.9208942626112806      1.914665265054602       1.9083568857996154   1.9019687841431212       1.8955006405106984      1.8889521571799868      1.8823230590054072      1.8756130941434244      1.8688220347774394   1.8619496778413478       1.8549958457407763      1.8479603870709727      1.840843177330289       1.8336441196281668      1.8263631453865086   1.8190002150332807       1.8115553186871645      1.8040284768320634      1.7964197409802238      1.7887291943227204      1.7809569523660331   1.773103163553422        1.7651680098697904      1.7571517074287144      1.7490545070402987      1.740876694758526       1.7326185924067399   1.7242805580799132       1.715862986622356       1.7073663100795078      1.6987909981224787      1.6901375584440061      1.6814065371245182   1.6725985189669994       1.6637141277993874      1.654754026743254       1.6457189184475394      1.6366095452861704      1.6274266895183978   1.6181711734107571       1.6088438593195882      1.5994456497330967      1.5899774872720134      1.580440354647934       1.5708352745785206   1.5611633096587731       1.5514255621876818      1.5416231739496227      1.5317573259499442      1.5218292381042695      1.5118401688811216   1.501791414897569        1.4916843104676707      1.4815202271035937      1.471300572969374       1.4610267922873852      1.4507003646976633   1.4403228045703693       1.4298956602717192      1.4194205133838784      1.408898977879346       1.3983326992505267      1.387723353595233    1.377072646659005        1.3663823128352024      1.355654114123955       1.3448898390511277      1.334091301548572       1.3232603397970242   1.3123988150331092       1.3015086103219795      1.2905916292972353      1.279649794869825       1.2686850479077303      1.2576993458882928   1.2466946615251286       1.235672981371629       1.224636304403121       1.213586640579804       1.2025260093926353      1.1914564383943893   1.1803799617181405       1.1692986185854717      1.158214451806713       1.1471295062755662      1.1360458274604597      1.1249654598950023   1.1138904456699077       1.1028228229287411      1.0917646243698502      1.0807178757568114
ENSMUSG00000000003      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA   NA       NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA   NA       NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA   NA       NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA   NA       NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA   NA       NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA      NA
ENSMUSG00000000028      2.000000261578661       1.9921621589473684      1.9842687414094864      1.9763203102771754      1.9683171834232485   1.9602596953839035       1.9521481974528418      1.9439830577665278      1.9357646613803303      1.9274934103353314      1.9191697237155516   1.910794037695379        1.9023668055769751      1.8938884978174588      1.885359602045647       1.8767806230681758      1.8681520828648093   1.8594745205727508       1.8507484924598074      1.841974571886235       1.833153349255128       1.8242854319512147      1.815371444267936    1.8064120273226982       1.7974078389601957      1.7883595536437265      1.779267862334418       1.7701334723583102      1.7609571072612502   1.7517395066515615       1.74248142603048        1.733183636610344       1.7238469251205617      1.7144720936013758      1.7050599591854718   1.695611353867492        1.6861271242615212      1.6766081313466457      1.6670552502006828      1.657469369722207       1.6478513923410114   1.6382022337171576       1.6285228224287822      1.618814099648852       1.6090770188110601      1.5993125452650907      1.5895216559214749   1.5797053388862967       1.5698645930859974      1.5600004278825739      1.5501138626794448      1.5402059265183048      1.5302776576672767   1.5203301032007004       1.510364318570903       1.5003813671723056      1.4903823198982429      1.4803682546908663      1.4703402560845382   1.4602994147431037       1.4502468269914681      1.4401835943418828      1.430110823015393       1.4200296234588594      1.4099411098580166   1.3998463996470154       1.3897466130148977      1.3796428724094765      1.3695363020390772      1.3594280273726205      1.3493191746385027   1.3392108703227694       1.3291042406670313      1.3190004111666245      1.3089005060694674      1.2988056478761036      1.288716956841398    1.2786355504783482       1.2685625430644907      1.2584990451513536      1.2484461630774173      1.2384049984850278      1.228376647841717    1.2183622019663645       1.2083627455606218      1.1983793567460346      1.1884131066072654      1.1784650587418262      1.1685362688167071   1.1586277841322885       1.1487406431939033      1.1388758752914103      1.1290345000871234      1.1192175272124314      1.1094259558734247   1.0996607744658402       1.0899229601996145      1.0802134787333215      1.070533283818762       1.0608833169559446      1.051264507058708    1.0416777701311803       1.0321240089552974      1.0226041127895504      1.013118957079147
ENSMUSG00000000031      1.0000009999989565      0.9771926384317687      0.954904497183259       0.9331247109273769      0.9118416849645907   0.8910440890494361       0.8707208513588435      0.8508611525980336      0.8314544202408477      0.812490322901435       0.7939587648343172   0.7758498805598883       0.7581540296124988      0.7408617914083201      0.7239639602302663      0.7074515403272948      0.6913157411254832   0.6755479725483301       0.660139840443791       0.6450831421156125      0.6303698619565862      0.6159921671814025      0.6019424036568244   0.5882130918269687       0.5747969227315228      0.561686754114778       0.5488756066234057      0.536356660090957       0.5241232499071031   0.5121688634696878       0.5004871367176992      0.4890718507433193      0.47791692848124584     0.4670164314735209      0.4563645567081519   0.4459556335298343       0.43578412062113514     0.4258446030525304      0.4161317893997245      0.40664050892671855     0.3973657088331271   0.3883024515642782       0.37944591218266477     0.370791375799349       0.36233423506394874     0.3540699877118773      0.3459942341675195   0.338102675202082        0.33039110964485674     0.3228554321466916      0.3154916309944681      0.30829578597542934     0.30126406629021724  0.2943927285135097       0.2876781146011726      0.2811166499428637      0.2747048414590538      0.2684392757414514      0.26231661723584077  0.25633360646636494      0.2504870583003122      0.24477386025247616     0.2391909708281937      0.23373541790417282     0.22840429714625127  0.22319477046324407      0.21810406449605554     0.21312946914125205     0.20826833610830797     0.20351807750976156     0.19887616448352252  0.19434012584660684      0.18990754677957314     0.18557606754096842     0.18134338221109206     0.17720723746441458     0.17316543136999407  0.16921581221925278      0.16535627738049116     0.1615847721795278      0.15789928880587004     0.1542978652438323      0.1507785842280348   0.14733957222272523      0.1439789984243796      0.1406950737870527      0.13748605006995823     0.13435021890677268     0.1312859108961655   0.1282914947130743       0.12536537624024852     0.12250599771960248     0.11971183692292434     0.11698140634149923     0.11431325239421591  0.11170595465373521      0.10915812509030866     0.10666840733284345     0.10423547594682192     0.10185803572868991     0.09953482101633938  0.09726459501531781      0.09504614914040505     0.09287830237220789     0.0907599006284299
```
The file of modeled derivatives predicted by either the random forest or the neural net needs a column called combined_index, and a column for each timepoint:
```
combined_index  0       1       2       3       4       5       6       7       8       9       10      11      12      13      14      15   16       17      18      19      20      21      22      23      24      25      26      27      28      29      30      31      32      33   34       35      36      37      38      39      40      41      42      43      44      45      46      47      48      49      50      51   52       53      54      55      56      57      58      59      60      61      62      63      64      65      66      67      68      69   70       71      72      73      74      75      76      77      78      79      80      81      82      83      84      85      86      87   88       89      90      91      92      93      94      95      96      97      98      99      100     101     102     103     104
ENSMUSG00000090264-forebrain-EM10D2584003       -0.021443956144045807   -0.020675566736395985   -0.019959201046996285   -0.019297136554093916-0.018691487510525934    -0.018144066555058177   -0.01765621527584783    -0.017228605744557278   -0.016861021392090097   -0.016552136519450623-0.0162993322044221      -0.016098617636089056   -0.015944779577507156   -0.015831976543567085   -0.015755161621159076   -0.015713019831761398-0.01571365108569129     -0.01578519509531736    -0.01599521077851556    -0.016484962028080398   -0.01752675289174984    -0.01960839083667163 -0.023518656099223594    -0.030300929889852887   -0.0407070861611084     -0.05367226325195232    -0.06454047355995865    -0.06666495065335792 -0.057800171904869344    -0.0428285669211661     -0.028191204794746762   -0.016991175373399402   -0.009318987238420031   -0.004192901325809075-0.0006520220695054807   0.001964195840433883    0.004050856432482486    0.005828909492909249    0.007417664151458994    0.008880451661875968 0.010250803840834908     0.011546772724935562    0.012778544968144396    0.013952402386739695    0.01507273490484578     0.016143033090040237 0.017166355828453772     0.018145534725525183    0.01908325153294963     0.019982058374782834    0.020844375512246053    0.02167248314471352  0.022468514412461827     0.023234452133105786    0.023972129622012908    0.02468323502276453     0.025369318274791466    0.026031799840275417 0.026671980430491984     0.027291051127606367    0.02789010345118721     0.028470139052447233    0.02903207882829417     0.029576771332176333 0.03010500042230306      0.030617492133763698    0.03111492079294038     0.031597914413620344    0.03206705942704908     0.03252290480500438  0.032965965637535566     0.03339672622661637     0.03381564275460835     0.03422314558286169     0.03461964123152732     0.03500551408709773  0.03538112787959738      0.0357468269668715      0.036102937459190874    0.036449768213446344    0.03678761172258886     0.037116744922667644 0.03743742993683345      0.037749914772968546    0.03805443398916683     0.038351209339080754    0.03864045040714856     0.03892235524189391  0.039197110993821525     0.039464894562898735    0.03972587325919802     0.03998020547896412     0.04022804139715285     0.04046952367636014  0.040704788191019796     0.040933964764787466    0.04115717791815993     0.04137454762259796     0.04158619005673622     0.04179221835968076  0.04199274337592111      0.0421878743860202      0.0423777198170062      0.0425623879262709      0.042741987452785006
ENSMUSG00000072620-midbrain-EM10D1246505        0.3550414284830037      0.2634913635363989      0.21427529099667958     0.18620602781547654  0.1651472980766192       0.14731688781954466     0.13224314155744643     0.11969584147202292     0.10935141748142824     0.10091775087689146  0.09414917202900734      0.08881801116093788     0.08470073698509369     0.08158123452443182     0.07925978344374429     0.0775600488143709   0.07633184912352811      0.07545040510323803     0.07481356676347764     0.07433829974323275     0.07395723969567264     0.07361571464822197  0.07326936551317335      0.0728823449477557      0.0724260050266308      0.07187796131677032     0.07122142278877042     0.07044469060176844  0.0695407471610065       0.06850687635235019     0.06734427462996959     0.06605762961971204     0.06465465743788142     0.06314560157566314  0.06154270472235047      0.05985967026615453     0.05811113261070698     0.05631215527160508     0.05447777351761166     0.05262259472708831  0.05076046528237968      0.04890420830430657     0.047065432307242784    0.04525440726730352     0.04348000183525354     0.041749673557259455 0.04006950295363742      0.038444262039909194    0.03687750820679447     0.0353716951430124      0.033928293529880534    0.032547915422029006 0.031230437443054024     0.02997511908625443     0.028780713463472444    0.02764556875781945     0.026567719395665237    0.025544966560691572 0.02457494813838327      0.023655198519053545    0.02278319892009727     0.021956419032862405    0.021172350874637407    0.020428535748286528 0.0197225851952786       0.01905219678410907     0.018415165514986464    0.01780939155061203     0.017232884907555524    0.016683767667257515 0.016160274192891812     0.01566074977011158     0.015183648027157073    0.0147275274334921      0.01429104712617009     0.013872962269364113 0.0134721191146125       0.013087449896817578    0.012717967673464415    0.012362761191272734    0.012020989845131684    0.011691878778099735 0.011374714158104808     0.011068838656271396    0.010773647143189728    0.01048858261257878     0.010213132336406723    0.009946824251349814 0.009689223573284037     0.009439929634152966    0.009198572933835856    0.008964812398480937    0.00873833283599824     0.008518842579003462 0.008306071305319384     0.008099768026173106    0.007899699232404788    0.007705647189257401    0.0075174083706818886   0.007334792024461669 0.007157618859883756     0.0069857198501002485   0.00681893514174904     0.006657113064798876    0.006500109235992046
ENSMUSG00000069743-hindbrain-EM10D2550322       -0.15298214703368593    -0.15004397764262156    -0.14715171745341837    -0.14430440471571762 -0.14150123721635952     -0.13874157623574587    -0.13602494721866643    -0.1333510368944463     -0.13071968670304984    -0.12813088251256666 -0.12558474074294684     -0.1230814911346081     -0.12062145651277993    -0.11820502999416661    -0.11583265015804561    -0.11350477475691409 -0.11122185357153062     -0.10898430102234792    -0.10679246913589804    -0.10464662143370969    -0.10254690826653076    -0.10049334406208668 -0.09848578689439297     -0.09652392072050675    -0.0946072405697223     -0.0927350409129728     -0.09090640738814766    -0.08912021201077769 -0.08737511195887977     -0.0856695519847186     -0.08400177047333932    -0.08236980913600714    -0.08077152629417217    -0.07920461367422653 -0.0776666165934951      -0.07615495737238298    -0.07466696175583884    -0.07319988806946161    -0.07175095877268353    -0.07031739400522963 -0.06889644665601458     -0.06748543841878862    -0.06608179623963768    -0.06468308851145264    -0.06328706033320211    -0.061891667130387455-0.060495105930006676    -0.059095843600455555   -0.05769264140491812    -0.05628457527579052    -0.054871051296401505   -0.05345181597263321 -0.05202696098810647     -0.05059692225882259    -0.04916247323252373    -0.047724712510332425   -0.04628504599921879    -0.04484516392941714 -0.043407013187380085    -0.041972765518922255   -0.040544782246136994   -0.03912557621332367    -0.03771777172999789    -0.03632406331207652 -0.03494717403515246     -0.03358981430647787    -0.03225464183548212    -0.030944223537400325   -0.029661000042391313   -0.0284072534052741  -0.02718507852100789     -0.025996358650931847   -0.02484274535749429    -0.023725643033928486   -0.022646198103360146   -0.021605292852514033-0.020603543761728894    -0.019641304098405348   -0.01871867045789924    -0.017835492866372343   -0.0169913880057614     -0.016185755082704565-0.015417793841196892    -0.014686524212459475   -0.013990807103949485   -0.013329365851018578   -0.012700807887437975   -0.012103646232589822-0.011536320441146202    -0.010997216713103386   -0.010484686915804942   -0.00999706632297771    -0.009532689927030973   -0.009089907228482137-0.008667095449294827    -0.00826267115444106    -0.007875100297774556   -0.0075029067342770196  -0.007144679261130887   -0.006799077265304555-0.00646483506596824     -0.006140765046750527   -0.005825759676286866   -0.005518792516383729   -0.0052189183160649515
```
The output format depends on the running mode selected. Single-gene mode produces a text file with the reconstructed gene expression value at each timepoint on its own line:
```
2.0000009999597714
1.9864202534124273
1.970736494777169
1.9528113120211568
```
All mode produces a tab-separated table with a column for each timepoint and a row for each gene shared that was found in both input sets:
```
gene_id	0	1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16	17	18	19	20	21	22	23	24	25	26	27	28	29	30	31	32	33	34	35	36	37	38	39	40	41	42	43	44	45	46	47	48	49	50	51	52	53	54	55	56	57	58	59	60	61	62	63	64	65	66	67	68	69	70	71	72	73	74	75	76	77	78	79	80	81	82	83	84	85	86	87	88	89	90	91	92	93	94	95	96	97	98	99	100	101	102	103	104
ENSMUSG00000001039	2.0000009999597714	1.9864202534124273	1.970736494777169	1.9528113120211568	1.933051237831169	1.9124960576403722	1.892551454122751	1.874465306425812	1.8589192624667266	1.8459801090157235	1.8353155977436146	1.826448599560188	1.8189224872696177	1.8123696991902734	1.8065211695999022	1.80119100322382	1.7962556556747653	1.791635510618351	1.7872808892974623	1.7831621948308845	1.779263246943367	1.7755768705099588	1.7721019971912608	1.7688417464029025	1.7658021178519376	1.7629910476541808	1.760417662529179	1.7580916227201389	1.7560224834118674	1.754219033480387	1.752688594213783	1.7514362821617402	1.750464260817321	1.749771025168599	1.7493507795974905	1.7491929803204653	1.749282115206318	1.7495977834722134	1.7501151142164924	1.7508055275061472	1.751637799533502	1.7525793516198234	1.7535976500761659	1.7546615873978724	1.7557427187928003	1.7568162507888123	1.757861715412669	1.7588633062274168	1.7598098930232433	1.7606947636096546	1.7615151604195636	1.7622716861625547	1.7629676486718169	1.7636084038101552	1.7642007404761832	1.7647523364474464	1.7652713001271862	1.7657658023571472	1.7662437946479927	1.7667128052465404	1.7671798018986973	1.7676511093752312	1.7681323702296468	1.7686285383728664	1.7691438965135073	1.7696820900717218	1.7702461716683207	1.7708386516296573	1.7714615510929228	1.7721164552389983	1.7728045649330393	1.7735267456386081	1.7742835729152358	1.7750753741375218	1.7759022663098702	1.7767641900151812	1.7776609396453893	1.7785921901305317	1.7795575204220342	1.7805564340036644	1.7815883767065983	1.782652752098183	1.7837489347008089	1.7848762812804504	1.7860341404257116	1.7872218606189052	1.788438796981633	1.789684316859086	1.790957804390137	1.7922586641944638	1.7935863242934307	1.7949402383683204	1.7963198874476394	1.7977247811045802	1.7991544582361962	1.8006084874873445	1.8020864673748749	1.8035880261607995	1.8051128215171772	1.8066605400201141	1.8082308965055391	1.8098236333152025	1.8114385194575986	1.8130753497051955	1.8147339436463965
ENSMUSG00000001366	1.0000005112607953	1.0131987265407805	1.0262204390773904	1.0390441604711225	1.0516535012924078	1.0640355378476654	1.076179456168783	1.0880755924402543	1.09971485703202	1.1110884639309555	1.1221878710261013	1.133004847094875	1.1435316016022607	1.1537609339791477	1.163686375827062	1.1733023116298107	1.182604071603651	1.191587995282608	1.2002514672700297	1.2085929280440357	1.2166118633169989	1.2243087755711117	1.2316851412458272	1.2387433567725485	1.2454866763148988	1.2519191437221662	1.2580455208616939	1.2638712141740351	1.2694022009973671	1.2746449569363654	1.2796063853053246	1.2842937494548585	1.2887146085948211	1.2928767575518194	1.2967881707464557	1.3004569505418282	1.3038912799993692	1.3070993799793273	1.3100894704395762	1.312869735716389	1.3154482935128131	1.3178331672727155	1.3200322615799023	1.3220533401904138	1.3239040062806535	1.3255916844729803	1.3271236041823775	1.3285067838114704	1.3297480153052323	1.3308538485600325	1.3318305751631847	1.3326842109179935	1.3334204765848214	1.334044776240674	1.3345621726284531	1.3349773588333913	1.3352946255903073	1.3355178234948417	1.3356503193704174	1.3356949460389584	1.33565394476989	1.3355288997564017	1.335320664114861	1.335029277155782	1.3346538730765427	1.3341925818332714	1.3336424238317504	1.3329992013180418	1.3322573910422173	1.3314100450084652	1.330448708992872	1.3293633720443454	1.328142464334642	1.3267729252874436	1.3252403684521934	1.3235293733156075	1.321623935950533	1.3195081084006772	1.3171668489014061	1.3145870892339975	1.311758999965103	1.3086773986954683	1.3053432029658705	1.301764784034144	1.2979590402803487	1.293951992437082	1.289778720036199	1.28548251740393	1.281113246217441	1.2767249850653706	1.27237319827456	1.2681117357742415	1.2639900083016913	1.2600506484778766	1.2563278778839815	1.2528466781314502	1.2496227407497087	1.2466630727060923	1.2439670762605723	1.241527905417016	1.239333918325879	1.237370082720314	1.2356192369446632	1.2340631524997345	1.2326833794704843
ENSMUSG00000001472	0.9998183996685308	1.0304834388749835	1.0513223972192403	1.0694400715296841	1.0874489899530904	1.106258853666873	1.1262787510663521	1.1477888082949768	1.1710383203659498	1.196258641362589	1.223645935594591	1.2533301631104345	1.285337458520437	1.3195527379638983	1.3556912344894834	1.3932886637773616	1.4317178961542796	1.4702345807327517	1.5080462419106735	1.5443919034111033	1.5786157021670506	1.6102200189723006	1.6388903368891317	1.6644921822445702	1.687046821182542	1.7066951636600267	1.72365878108086	1.7382044395395035	1.750615574930862	1.7611716711109828	1.7701349164830296	1.7777427515291786	1.7842047403904742	1.789702349333611	1.7943905010767234	1.7984000787360244	1.8018408187405996	1.8048042389432997	1.8073663973008276	1.8095903775254316	1.811528462681865	1.8132239964105348	1.8147129527514128	1.816025245655993	1.8171858125572966	1.8182155057282734	1.819131822465575	1.819949501542506	1.8206810095619297	1.82133693718245	1.8219263218755162	1.8224569109700008	1.8229353762623492	1.8233674893883194	1.8237582654244082	1.8241120807659035	1.8244327701675003	1.8247237068887365	1.8249878691223835	1.8252278952669712	1.825446130107524	1.8256446635686658	1.8258253633828254	1.825989902758102	1.8261397839230307	1.8262763582589938	1.8264008435972698	1.8265143391502061	1.8266178384595044	1.826712240674954	1.8267983604207727	1.8268769364613422	1.8269486393414158	1.8270140781461037	1.827073806501747	1.8271283279190746	1.827178100563924	1.8272235415275964	1.8272650306580427	1.8273029140041084	1.8273375069176163	1.827369096851873	1.8273979458900032	1.8274242930321574	1.8274483562669694	1.8274703344495131	1.8274904090053559	1.8275087454780259	1.8275254949352486	1.8275407952476137	1.8275547722518592	1.827567540809673	1.827579205771784	1.8275898628561253	1.8275995994479728	1.8276084953291851	1.8276166233429871	1.8276240500001124	1.8276308360315787	1.8276370368928727	1.8276427032238771	1.8276478812684758	1.8276526132574102	1.827656937757639	1.8276608899911557
```
#### Example
Using single-gene mode:
```
python euler_method.py \
	--valuesfile "example_dir/rna_vals.tsv" \
	--predictfile "myfolder/rf_predictions.tsv" \
	--outfile "myfolder/rf_euler.txt" \
	-m "gene"
	--gene TK
```
Using all mode:
```
python euler_method.py \
	--valuesfile "example_dir/rna_vals.tsv" \
	--predictfile "myfolder/rf_predictions.tsv" \
	--outfile "myfolder/rf_euler.tsv" \
	--mode "all"
```

