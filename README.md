# *chronODE*: A framework to integrate time-series multi-omics data based on ordinary differential equations combined with machine learning
Beatrice Borsari, Mor Frank, Eve S. Wattenberg, Susanna X. Liu, Xuezhu Yu, Mark Gerstein  
[bioRxiv preprint](https://www.biorxiv.org/content/10.1101/2023.12.13.571513v1)  

***

## Requirements

    pandas=2.2.1
    

## Example running
Run pipeline on open chromatin data from mouse forebrain decreasing cCREs:  

    python ODE_fitting_posvals.py \
      --inputfile "example_dir/open_chromatin_example_input.tsv" \
      --timepoints 105 \
      --timecourse "mouse" \
      --group "decreasing" \
      --region "forebrain" \
      --assay "open_chromatin" \
      --valuesfile "example_dir/oc_vals.tsv" \
      --derivsfile "example_dir/oc_derivs.tsv" \
      --paramsfile "example_dir/oc_params.tsv"
Run pipeline on DNase-seq data from human brain:  

    python ODE_fitting_posvals.py \
      --inputfile "example_dir/human_rnaseq.tsv" \
      --timepoints 105 \
      --timecourse "human" \
      --assay "DNase" \
      --valuesfile "example_dir/dnase_vals.tsv" \
      --derivsfile "example_dir/dnase_derivs.tsv" \
      --paramsfile "example_dir/dnase_params.tsv"


## Random Forest

### File formats
output:
```
combined_index	0	1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16	17	18	19	20	21	22	23	24	25	26	27	28	29	30	31	32	33	34	35	36	37	38	39	40	41	42	43	44	45	46	47	48	49	50	51	52	53	54	55	56	57	58	59	60	61	62	63	64	65	66	67	68	69	70	71	72	73	74	75	76	77	78	79	80	81	82	83	84	85	86	87	88	89	90	91	92	93	94	95	96	97	98	99	100	101	102	103	104
ENSMUSG00000039703-forebrain-EM10D3074493	-0.2625324998352258	-0.25478173365352913	-0.24735001435865087	-0.24022345509986845	-0.23338882387703863	-0.22683346487937184	-0.22054521936040727	-0.21451234635278596	-0.20872344393435788	-0.2031673721599803	-0.19783317905158018	-0.1927100310188509	-0.18778714855714387	-0.18305374685531725	-0.17849897899400907	-0.17411187695877983	-0.1698812834241137	-0.16579576644846877	-0.16184351163944113	-0.1580121939217417	-0.15428884500763715	-0.15065975235645024	-0.14711044691467307	-0.1436258524419062	-0.14019066802376542	-0.13679002731587842	-0.13341041941659226	-0.13004077563008787	-0.12667354676293738	-0.1233055487981739	-0.11993836797061397	-0.1165781964939453	-0.11323509665365306	-0.10992182169760253	-0.10665241271261165	-0.10344081524508278	-0.10029971923118736	-0.09723974483150323	-0.09426900711589832	-0.09139302020105688	-0.08861485898767281	-0.08593548378997674	-0.0833541418200932	-0.0808687794657065	-0.07847642203646771	-0.07617349777628665	-0.07395609807493903	-0.07182017569054806	-0.06976168825545172	-0.06777669659741505	-0.0658614276243906	-0.06401231060815621	-0.06222599429445764	-0.06049935075796555	-0.05882947052382243	-0.057213652289349104	-0.05564938962372806	-0.05413435628603767	-0.05266639125174541	-0.05124348413887118	-0.04986376144360914	-0.04852547380202888	-0.047226984365890436	-0.04596675829817516	-0.04474335334374406	-0.04355541140236351	-0.04240165101780027	-0.041280860692594505	-0.04019189293984435	-0.03913365898844064	-0.03810512406503823	-0.03710530318359633	-0.036133257380901486	-0.03518809034372858	-0.03426894537997661	-0.03337500269215228	-0.03250547691694472	-0.031659614899353414	-0.030836693673953485	-0.03003601862946141	-0.029256921835853763	-0.028498760515966563	-0.027760915645799078	-0.027042790669734574	-0.026343810318593928	-0.02566341951991922	-0.025001082391154617	-0.02435628130749799	-0.02372851603715244	-0.023117302937539032	-0.022522174206756125	-0.02194267718520398	-0.02137837370284609	-0.020828839468064717	-0.02029366349449452	-0.019772447562594563	-0.019264805713051093	-0.018770363769396302	-0.018288758887490226	-0.017819639129741716	-0.017362663062153103	-0.016917499372453463	-0.016483826507750404	-0.0160613323302765	-0.01564971378993606
ENSMUSG00000041895-midbrain-EM10D2386250	0.21748892698510805	0.16237279764122636	0.11835493752652373	0.08402078093616874	0.057404953956934464	0.03667509197989748	0.020395645660269936	0.007538533157808241	-0.0026181435389332247	-0.010604484205879774	-0.016839240428554676	-0.021671262520441673	-0.025395899659609835	-0.028260966160822854	-0.030470703602105194	-0.03219067502576487	-0.03355371001172213	-0.03466618530245821	-0.03561400042358997	-0.036467920265436306	-0.037288231188238624	-0.03812882884036442	-0.03904093173558869	-0.0400766031366697	-0.04129214112477244	-0.042751086694481986	-0.0445259617335668	-0.04669669948343552	-0.04934197976992948	-0.05251774667935265	-0.05621683868746943	-0.06030896729202473	-0.06447659609688745	-0.06818905320042179	-0.07077430710507328	-0.07161485518364824	-0.07039708582013877	-0.0672590626262324	-0.06272663264911613	-0.057486487906253145	-0.052151876985400795	-0.0471367290942729	-0.0426472168931231	-0.03873687909709961	-0.03537232202722269	-0.032483197020144274	-0.029991814287123993	-0.027827201811673676	-0.025929869936396645	-0.024251980242833975	-0.02275570987661383	-0.021411214981439147	-0.02019478294241257	-0.019087350966733606	-0.0180733885173023	-0.01714007893871171	-0.016276726235956305	-0.01547432336296724	-0.014725233479544202	-0.014022949478624034	-0.01336190792486208	-0.01273734137060457	-0.012145158391952224	-0.011581844263011393	-0.01104437751221107	-0.010530159096861695	-0.010036951884155609	-0.00956282873605077	-0.009106127890963598	-0.008665414598761535	-0.008239448148355475	-0.007827153560319449	-0.0074275973192188816	-0.007039966602711676	-0.006663551533521023	-0.006297730039814034	-0.005941954961539888	-0.005595743086235942	-0.00525866583852906	-0.004930341383659918	-0.004610427937257331	-0.004298618101757555	-0.003994634074597885	-0.003698223594959561	-0.0034091565147753118	-0.0031272218961467726	-0.0028522255516053243	-0.00258398795599447	-0.0023223424694382624	-0.0020671338200269384	-0.0018182168027893193	-0.001575455158280995	-0.0013387205999807225	-0.0011078919646357666	-0.000882854464012256	-0.0006634990201112623	-0.0004497216690704091	-0.00024142302158402192	-3.8507769976289625e-05	0.00015911576605011745	0.0003515360613230426	0.0005388387797262609	0.0007211071451451441	0.0008984222916715194	0.0010708635950900517
```
### Example
```
python randomforest.py \
  -i myfolder/rf_input.tsv \
  -p myfolder/rf_predictions.tsv \
  -s 42
  ```